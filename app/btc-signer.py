from bitcoinlib.keys import HDKey
from bitcoinlib.transactions import Transaction
from app.config import settings

hd_key = HDKey(settings.BTC_PRIVATE_KEY_HEX)
assert hd_key.address() == settings.BTC_EXPECTED_ADDRESS

UNSIGNED_RAW_TX_HEX = "01000000016ab20afc86c9dea194149ef388a0967459d01a18cded92403ff7ae43eb7b9405000000006b483045022100f6a765d5e54eecd4fd5b5288418ba520c72c9eefaa0eb427ac1f48d3a07bd52702200ea5517e1e456772879213569054cd1040acb952ad93a0258292643149ad32b2412103fe410256e89bcc197043715991ce107ecdb95294a0bfb1e2cf922f354e1c9cf5ffffffff03e0673500000000001976a914ff3772ac4d3548d4890be6d5770b9ff138bf9dad88ac00000000000000001976a9144fabc47a4c3b5f8cadad3cee01b95e0f6621c12188ac40ea0c00000000001976a9144fabc47a4c3b5f8cadad3cee01b95e0f6621c12188ac00000000"

tx = Transaction.parse_hex(UNSIGNED_RAW_TX_HEX)

tx.sign(hd_key)
